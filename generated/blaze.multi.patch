From 51e340b7cd2b944bd0929206b1871f1c044c2aa2 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:05:51 -0700
Subject: [PATCH 01/48] Step 1: Run `meteor create`

---
 .gitignore                  |  1 +
 .meteor/.finished-upgraders | 13 +++++++++
 .meteor/.gitignore          |  1 +
 .meteor/.id                 |  7 +++++
 .meteor/packages            | 21 ++++++++++++++
 .meteor/platforms           |  2 ++
 .meteor/release             |  1 +
 .meteor/versions            | 69 +++++++++++++++++++++++++++++++++++++++++++++
 client/main.css             |  1 +
 client/main.html            | 25 ++++++++++++++++
 client/main.js              | 22 +++++++++++++++
 package.json                | 10 +++++++
 server/main.js              |  5 ++++
 13 files changed, 178 insertions(+)
 create mode 100644 .gitignore
 create mode 100644 .meteor/.finished-upgraders
 create mode 100644 .meteor/.gitignore
 create mode 100644 .meteor/.id
 create mode 100644 .meteor/packages
 create mode 100644 .meteor/platforms
 create mode 100644 .meteor/release
 create mode 100644 .meteor/versions
 create mode 100644 client/main.css
 create mode 100644 client/main.html
 create mode 100644 client/main.js
 create mode 100644 package.json
 create mode 100644 server/main.js

diff --git a/.gitignore b/.gitignore
new file mode 100644
index 0000000..3c3629e
--- /dev/null
+++ b/.gitignore
@@ -0,0 +1 @@
+node_modules
diff --git a/.meteor/.finished-upgraders b/.meteor/.finished-upgraders
new file mode 100644
index 0000000..dacc2c0
--- /dev/null
+++ b/.meteor/.finished-upgraders
@@ -0,0 +1,13 @@
+# This file contains information which helps Meteor properly upgrade your
+# app when you run 'meteor update'. You should check it into version control
+# with your project.
+
+notices-for-0.9.0
+notices-for-0.9.1
+0.9.4-platform-file
+notices-for-facebook-graph-api-2
+1.2.0-standard-minifiers-package
+1.2.0-meteor-platform-split
+1.2.0-cordova-changes
+1.2.0-breaking-changes
+1.3.0-split-minifiers-package
diff --git a/.meteor/.gitignore b/.meteor/.gitignore
new file mode 100644
index 0000000..4083037
--- /dev/null
+++ b/.meteor/.gitignore
@@ -0,0 +1 @@
+local
diff --git a/.meteor/.id b/.meteor/.id
new file mode 100644
index 0000000..9a3be4f
--- /dev/null
+++ b/.meteor/.id
@@ -0,0 +1,7 @@
+# This file contains a token that is unique to your project.
+# Check it into your repository along with the rest of this directory.
+# It can be used for purposes such as:
+#   - ensuring you don't accidentally deploy one app on top of another
+#   - providing package authors with aggregated statistics
+
+1v2pn7n1jbklfu1hg4tnm
diff --git a/.meteor/packages b/.meteor/packages
new file mode 100644
index 0000000..d4c8001
--- /dev/null
+++ b/.meteor/packages
@@ -0,0 +1,21 @@
+# Meteor packages used by this project, one per line.
+# Check this file (and the other files in this directory) into your repository.
+#
+# 'meteor add' and 'meteor remove' will edit this file for you,
+# but you can also edit it by hand.
+
+meteor-base             # Packages every Meteor app needs to have
+mobile-experience       # Packages for a great mobile UX
+mongo                   # The database Meteor supports right now
+blaze-html-templates    # Compile .html files into Meteor Blaze views
+reactive-var            # Reactive variable for tracker
+jquery                  # Helpful client-side library
+tracker                 # Meteor's client-side reactive programming library
+
+standard-minifier-css   # CSS minifier run for production mode
+standard-minifier-js    # JS minifier run for production mode
+es5-shim                # ECMAScript 5 compatibility for older browsers.
+ecmascript              # Enable ECMAScript2015+ syntax in app code
+
+autopublish             # Publish all data to the clients (for prototyping)
+insecure                # Allow all DB writes from clients (for prototyping)
diff --git a/.meteor/platforms b/.meteor/platforms
new file mode 100644
index 0000000..efeba1b
--- /dev/null
+++ b/.meteor/platforms
@@ -0,0 +1,2 @@
+server
+browser
diff --git a/.meteor/release b/.meteor/release
new file mode 100644
index 0000000..ab70657
--- /dev/null
+++ b/.meteor/release
@@ -0,0 +1 @@
+METEOR@1.3-rc.2
diff --git a/.meteor/versions b/.meteor/versions
new file mode 100644
index 0000000..c3395d2
--- /dev/null
+++ b/.meteor/versions
@@ -0,0 +1,69 @@
+allow-deny@1.0.2-rc.2
+autopublish@1.0.5-rc.2
+autoupdate@1.2.6-rc.2
+babel-compiler@6.5.1-rc.2
+babel-runtime@0.1.6-rc.2
+base64@1.0.6-rc.2
+binary-heap@1.0.6-rc.2
+blaze@2.1.5-rc.2
+blaze-html-templates@1.0.2-rc.2
+blaze-tools@1.0.6-rc.2
+boilerplate-generator@1.0.6-rc.2
+caching-compiler@1.0.2-rc.2
+caching-html-compiler@1.0.4-rc.2
+callback-hook@1.0.6-rc.2
+check@1.1.2-rc.2
+ddp@1.2.3-rc.2
+ddp-client@1.2.3-rc.2
+ddp-common@1.2.3-rc.2
+ddp-server@1.2.4-rc.2
+deps@1.0.10-rc.2
+diff-sequence@1.0.3-rc.2
+ecmascript@0.4.1-rc.2
+ecmascript-runtime@0.2.8-rc.2
+ejson@1.0.9-rc.2
+es5-shim@4.5.8-rc.2
+fastclick@1.0.9-rc.2
+geojson-utils@1.0.6-rc.2
+hot-code-push@1.0.2-rc.2
+html-tools@1.0.7-rc.2
+htmljs@1.0.7-rc.2
+http@1.1.3-rc.2
+id-map@1.0.5-rc.2
+insecure@1.0.5-rc.2
+jquery@1.11.6-rc.2
+launch-screen@1.0.7-rc.2
+livedata@1.0.16-rc.2
+logging@1.0.10-rc.2
+meteor@1.1.12-rc.2
+meteor-base@1.0.2-rc.2
+minifier-css@1.1.9-rc.2
+minifier-js@1.1.9-rc.2
+minimongo@1.0.12-rc.2
+mobile-experience@1.0.2-rc.2
+mobile-status-bar@1.0.9-rc.2
+modules@0.5.1-rc.2
+modules-runtime@0.6.1-rc.2
+mongo@1.1.5-rc.2
+mongo-id@1.0.2-rc.2
+npm-mongo@1.4.41-rc.2
+observe-sequence@1.0.9-rc.2
+ordered-dict@1.0.5-rc.2
+promise@0.6.4-rc.2
+random@1.0.7-rc.2
+reactive-var@1.0.7-rc.2
+reload@1.1.6-rc.2
+retry@1.0.5-rc.2
+routepolicy@1.0.8-rc.2
+spacebars@1.0.9-rc.2
+spacebars-compiler@1.0.9-rc.2
+standard-minifier-css@1.0.4-rc.2
+standard-minifier-js@1.0.4-rc.2
+templating@1.1.7-rc.2
+templating-tools@1.0.2-rc.2
+tracker@1.0.11-rc.2
+ui@1.0.9-rc.2
+underscore@1.0.6-rc.2
+url@1.0.7-rc.2
+webapp@1.2.6-rc.2
+webapp-hashing@1.0.7-rc.2
diff --git a/client/main.css b/client/main.css
new file mode 100644
index 0000000..b6b4052
--- /dev/null
+++ b/client/main.css
@@ -0,0 +1 @@
+/* CSS declarations go here */
diff --git a/client/main.html b/client/main.html
new file mode 100644
index 0000000..6fe0dc5
--- /dev/null
+++ b/client/main.html
@@ -0,0 +1,25 @@
+<head>
+  <title>simple</title>
+</head>
+
+<body>
+  <h1>Welcome to Meteor!</h1>
+
+  {{> hello}}
+  {{> info}}
+</body>
+
+<template name="hello">
+  <button>Click Me</button>
+  <p>You've pressed the button {{counter}} times.</p>
+</template>
+
+<template name="info">
+  <h2>Learn Meteor!</h2>
+  <ul>
+    <li><a href="https://www.meteor.com/try">Do the Tutorial</a></li>
+    <li><a href="http://guide.meteor.com">Follow the Guide</a></li>
+    <li><a href="https://docs.meteor.com">Read the Docs</a></li>
+    <li><a href="https://forums.meteor.com">Discussions</a></li>
+  </ul>
+</template>
diff --git a/client/main.js b/client/main.js
new file mode 100644
index 0000000..ecb3282
--- /dev/null
+++ b/client/main.js
@@ -0,0 +1,22 @@
+import { Template } from 'meteor/templating';
+import { ReactiveVar } from 'meteor/reactive-var';
+
+import './main.html';
+
+Template.hello.onCreated(function helloOnCreated() {
+  // counter starts at 0
+  this.counter = new ReactiveVar(0);
+});
+
+Template.hello.helpers({
+  counter() {
+    return Template.instance().counter.get();
+  },
+});
+
+Template.hello.events({
+  'click button'(event, instance) {
+    // increment the counter when button is clicked
+    instance.counter.set(instance.counter.get() + 1);
+  },
+});
diff --git a/package.json b/package.json
new file mode 100644
index 0000000..4164b14
--- /dev/null
+++ b/package.json
@@ -0,0 +1,10 @@
+{
+  "name": "simple-todos",
+  "private": true,
+  "scripts": {
+    "start": "meteor run"
+  },
+  "dependencies": {
+    "meteor-node-stubs": "~0.2.0"
+  }
+}
diff --git a/server/main.js b/server/main.js
new file mode 100644
index 0000000..31a9e0e
--- /dev/null
+++ b/server/main.js
@@ -0,0 +1,5 @@
+import { Meteor } from 'meteor/meteor';
+
+Meteor.startup(() => {
+  // code to run on server at startup
+});
-- 
2.11.0


From 431f75b28f8ee985b3ac341da6c4d752d204b135 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:07:22 -0700
Subject: [PATCH 02/48] Step 2.1: Remove starter HTML code

---
 client/main.html | 22 ----------------------
 1 file changed, 22 deletions(-)

diff --git a/client/main.html b/client/main.html
index 6fe0dc5..7c48505 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1,25 +1,3 @@
 <head>
   <title>simple</title>
 </head>
-
-<body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
-  {{> info}}
-</body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
-
-<template name="info">
-  <h2>Learn Meteor!</h2>
-  <ul>
-    <li><a href="https://www.meteor.com/try">Do the Tutorial</a></li>
-    <li><a href="http://guide.meteor.com">Follow the Guide</a></li>
-    <li><a href="https://docs.meteor.com">Read the Docs</a></li>
-    <li><a href="https://forums.meteor.com">Discussions</a></li>
-  </ul>
-</template>
-- 
2.11.0


From 99cffc464f80899ce34cf446179e8041c9f5114c Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 13:11:52 +1100
Subject: [PATCH 03/48] Step 2.2: Add starter HTML code

---
 imports/ui/body.html | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 imports/ui/body.html

diff --git a/imports/ui/body.html b/imports/ui/body.html
new file mode 100644
index 0000000..23a6507
--- /dev/null
+++ b/imports/ui/body.html
@@ -0,0 +1,17 @@
+<body>
+  <div class="container">
+    <header>
+      <h1>Todo List</h1>
+    </header>
+
+    <ul>
+      {{#each tasks}}
+        {{> task}}
+      {{/each}}
+    </ul>
+  </div>
+</body>
+
+<template name="task">
+  <li>{{text}}</li>
+</template>
-- 
2.11.0


From 30e9ac16a2de85e74d5a6d92b16e41b37e7faf5e Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:07:50 -0700
Subject: [PATCH 04/48] Step 2.3: Add starter JS code

---
 imports/ui/body.js | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 imports/ui/body.js

diff --git a/imports/ui/body.js b/imports/ui/body.js
new file mode 100644
index 0000000..3ad20b1
--- /dev/null
+++ b/imports/ui/body.js
@@ -0,0 +1,11 @@
+import { Template } from 'meteor/templating';
+
+import './body.html';
+
+Template.body.helpers({
+  tasks: [
+    { text: 'This is task 1' },
+    { text: 'This is task 2' },
+    { text: 'This is task 3' },
+  ],
+});
-- 
2.11.0


From d63fe20a79a2dd9be0034b72bba93d9654d10d31 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:08:17 -0700
Subject: [PATCH 05/48] Step 2.4: Import starter JS

---
 client/main.js | 23 +----------------------
 1 file changed, 1 insertion(+), 22 deletions(-)

diff --git a/client/main.js b/client/main.js
index ecb3282..4e7c1a4 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,22 +1 @@
-import { Template } from 'meteor/templating';
-import { ReactiveVar } from 'meteor/reactive-var';
-
-import './main.html';
-
-Template.hello.onCreated(function helloOnCreated() {
-  // counter starts at 0
-  this.counter = new ReactiveVar(0);
-});
-
-Template.hello.helpers({
-  counter() {
-    return Template.instance().counter.get();
-  },
-});
-
-Template.hello.events({
-  'click button'(event, instance) {
-    // increment the counter when button is clicked
-    instance.counter.set(instance.counter.get() + 1);
-  },
-});
+import '../imports/ui/body.js';
-- 
2.11.0


From 63f980943c048f8084f5a42543ba3e13b4088800 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:13:09 +1100
Subject: [PATCH 06/48] Step 2.5: Add CSS

---
 client/main.css | 125 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 125 insertions(+)

diff --git a/client/main.css b/client/main.css
index b6b4052..ed5e77e 100644
--- a/client/main.css
+++ b/client/main.css
@@ -1 +1,126 @@
 /* CSS declarations go here */
+body {
+  font-family: sans-serif;
+  background-color: #315481;
+  background-image: linear-gradient(to bottom, #315481, #918e82 100%);
+  background-attachment: fixed;
+
+  position: absolute;
+  top: 0;
+  bottom: 0;
+  left: 0;
+  right: 0;
+
+  padding: 0;
+  margin: 0;
+
+  font-size: 14px;
+}
+
+.container {
+  max-width: 600px;
+  margin: 0 auto;
+  min-height: 100%;
+  background: white;
+}
+
+header {
+  background: #d2edf4;
+  background-image: linear-gradient(to bottom, #d0edf5, #e1e5f0 100%);
+  padding: 20px 15px 15px 15px;
+  position: relative;
+}
+
+#login-buttons {
+  display: block;
+}
+
+h1 {
+  font-size: 1.5em;
+  margin: 0;
+  margin-bottom: 10px;
+  display: inline-block;
+  margin-right: 1em;
+}
+
+form {
+  margin-top: 10px;
+  margin-bottom: -10px;
+  position: relative;
+}
+
+.new-task input {
+  box-sizing: border-box;
+  padding: 10px 0;
+  background: transparent;
+  border: none;
+  width: 100%;
+  padding-right: 80px;
+  font-size: 1em;
+}
+
+.new-task input:focus{
+  outline: 0;
+}
+
+ul {
+  margin: 0;
+  padding: 0;
+  background: white;
+}
+
+.delete {
+  float: right;
+  font-weight: bold;
+  background: none;
+  font-size: 1em;
+  border: none;
+  position: relative;
+}
+
+li {
+  position: relative;
+  list-style: none;
+  padding: 15px;
+  border-bottom: #eee solid 1px;
+}
+
+li .text {
+  margin-left: 10px;
+}
+
+li.checked {
+  color: #888;
+}
+
+li.checked .text {
+  text-decoration: line-through;
+}
+
+li.private {
+  background: #eee;
+  border-color: #ddd;
+}
+
+header .hide-completed {
+  float: right;
+}
+
+.toggle-private {
+  margin-left: 5px;
+}
+
+@media (max-width: 600px) {
+  li {
+    padding: 12px 15px;
+  }
+
+  .search {
+    width: 150px;
+    clear: both;
+  }
+
+  .new-task input {
+    padding-bottom: 5px;
+  }
+}
-- 
2.11.0


From bbe752d39cf04a51376c1cd089b053615cf08df9 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:15:47 +1100
Subject: [PATCH 07/48] Step 3.1: Create tasks collection

---
 imports/api/tasks.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/api/tasks.js

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
new file mode 100644
index 0000000..3bed819
--- /dev/null
+++ b/imports/api/tasks.js
@@ -0,0 +1,3 @@
+import { Mongo } from 'meteor/mongo';
+
+export const Tasks = new Mongo.Collection('tasks');
-- 
2.11.0


From 85ec00cdd88b93b68d2f3c517060594a8f015062 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:20:32 +1100
Subject: [PATCH 08/48] Step 3.2: Load tasks collection on the server

---
 server/main.js | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/server/main.js b/server/main.js
index 31a9e0e..ab941a4 100644
--- a/server/main.js
+++ b/server/main.js
@@ -1,5 +1 @@
-import { Meteor } from 'meteor/meteor';
-
-Meteor.startup(() => {
-  // code to run on server at startup
-});
+import '../imports/api/tasks.js';
-- 
2.11.0


From f6b008980d6f04b93e05bf777bdb0378308f4b57 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:16:03 +1100
Subject: [PATCH 09/48] Step 3.3: Load tasks from Tasks collection

---
 imports/ui/body.js | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index 3ad20b1..fc36022 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -1,11 +1,11 @@
 import { Template } from 'meteor/templating';
 
+import { Tasks } from '../api/tasks.js';
+
 import './body.html';
 
 Template.body.helpers({
-  tasks: [
-    { text: 'This is task 1' },
-    { text: 'This is task 2' },
-    { text: 'This is task 3' },
-  ],
+  tasks() {
+    return Tasks.find({});
+  },
 });
-- 
2.11.0


From 5181113b59242497a2593b844337a93944b7d78a Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:10:21 -0700
Subject: [PATCH 10/48] Step 4.1: Add form for new tasks

---
 imports/ui/body.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/body.html b/imports/ui/body.html
index 23a6507..0a1f952 100644
--- a/imports/ui/body.html
+++ b/imports/ui/body.html
@@ -2,6 +2,10 @@
   <div class="container">
     <header>
       <h1>Todo List</h1>
+
+      <form class="new-task">
+        <input type="text" name="text" placeholder="Type to add new tasks" />
+      </form>
     </header>
 
     <ul>
-- 
2.11.0


From 828c084621cc5bd0d9373d54f4eda6188260bbda Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:19:59 +1100
Subject: [PATCH 11/48] Step 4.2: Add event handler for form submit

---
 imports/ui/body.js | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index fc36022..42ad1d5 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -9,3 +9,23 @@ Template.body.helpers({
     return Tasks.find({});
   },
 });
+
+Template.body.events({
+  'submit .new-task'(event) {
+    // Prevent default browser form submit
+    event.preventDefault();
+
+    // Get value from form element
+    const target = event.target;
+    const text = target.children.text.value;
+
+    // Insert a task into the collection
+    Tasks.insert({
+      text,
+      createdAt: new Date(), // current time
+    });
+
+    // Clear form
+    target.text.value = '';
+  },
+});
-- 
2.11.0


From 0dc5c4c9c5bb0f8f769ef704a90a981de6090847 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:12:14 -0700
Subject: [PATCH 12/48] Step 4.3: Show newest tasks at the top

---
 imports/ui/body.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index 42ad1d5..6fbc9d5 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -6,7 +6,8 @@ import './body.html';
 
 Template.body.helpers({
   tasks() {
-    return Tasks.find({});
+    // Show newest tasks at the top
+    return Tasks.find({}, { sort: { createdAt: -1 } });
   },
 });
 
-- 
2.11.0


From 89bc3233dc87cba97d7e5a89f659dfc463b8da53 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:12:57 -0700
Subject: [PATCH 13/48] Step 5.1: Add buttons to Task component

---
 imports/ui/task.html | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 imports/ui/task.html

diff --git a/imports/ui/task.html b/imports/ui/task.html
new file mode 100644
index 0000000..c4ab8e5
--- /dev/null
+++ b/imports/ui/task.html
@@ -0,0 +1,9 @@
+<template name="task">
+  <li class="{{#if checked}}checked{{/if}}">
+    <button class="delete">&times;</button>
+
+    <input type="checkbox" checked="{{checked}}" class="toggle-checked" />
+
+    <span class="text">{{text}}</span>
+  </li>
+</template>
-- 
2.11.0


From acb70c80fb362a856eb7254d5b7dbe8492e2dc83 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:23:12 +1100
Subject: [PATCH 14/48] Step 5.2: Remove Tasks component from Body file

---
 imports/ui/body.html | 4 ----
 1 file changed, 4 deletions(-)

diff --git a/imports/ui/body.html b/imports/ui/body.html
index 0a1f952..c40a87b 100644
--- a/imports/ui/body.html
+++ b/imports/ui/body.html
@@ -15,7 +15,3 @@
     </ul>
   </div>
 </body>
-
-<template name="task">
-  <li>{{text}}</li>
-</template>
-- 
2.11.0


From 4f27c1302376e197c5e69b476f19d9cd13522ade Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:26:44 +1100
Subject: [PATCH 15/48] Step 5.3: Add event handlers for Task buttons

---
 imports/ui/task.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 imports/ui/task.js

diff --git a/imports/ui/task.js b/imports/ui/task.js
new file mode 100644
index 0000000..782f932
--- /dev/null
+++ b/imports/ui/task.js
@@ -0,0 +1,17 @@
+import { Template } from 'meteor/templating';
+
+import { Tasks } from '../api/tasks.js';
+
+import './task.html';
+
+Template.task.events({
+  'click .toggle-checked'() {
+    // Set the checked property to the opposite of its current value
+    Tasks.update(this._id, {
+      $set: { checked: ! this.checked },
+    });
+  },
+  'click .delete'() {
+    Tasks.remove(this._id);
+  },
+});
-- 
2.11.0


From a26ed7b132ec652a7c4cd9f088f7eb3300e86389 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:26:57 +1100
Subject: [PATCH 16/48] Step 5.4: Import Task component from the body

---
 imports/ui/body.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index 6fbc9d5..bac22c6 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -2,6 +2,7 @@ import { Template } from 'meteor/templating';
 
 import { Tasks } from '../api/tasks.js';
 
+import './task.js';
 import './body.html';
 
 Template.body.helpers({
-- 
2.11.0


From 4bfaa6f070101cb0caf35ab30343e1126b0e6701 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:24:18 -0700
Subject: [PATCH 17/48] Step 7.1: Add hide-completed checkbox to HTML

---
 imports/ui/body.html | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/ui/body.html b/imports/ui/body.html
index c40a87b..b634377 100644
--- a/imports/ui/body.html
+++ b/imports/ui/body.html
@@ -3,6 +3,11 @@
     <header>
       <h1>Todo List</h1>
 
+      <label class="hide-completed">
+        <input type="checkbox" />
+        Hide Completed Tasks
+      </label>
+
       <form class="new-task">
         <input type="text" name="text" placeholder="Type to add new tasks" />
       </form>
-- 
2.11.0


From 11349ad2cad437421ad9fadb05f000fc2f24d928 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:33:00 +1100
Subject: [PATCH 18/48] Step 7.2: Add reactive-dict package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index d4c8001..a113025 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+reactive-dict
diff --git a/.meteor/versions b/.meteor/versions
index c3395d2..ccbd7bb 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -51,6 +51,7 @@ observe-sequence@1.0.9-rc.2
 ordered-dict@1.0.5-rc.2
 promise@0.6.4-rc.2
 random@1.0.7-rc.2
+reactive-dict@1.1.5-rc.2
 reactive-var@1.0.7-rc.2
 reload@1.1.6-rc.2
 retry@1.0.5-rc.2
-- 
2.11.0


From 349bd90805ba098d08c9445c00fb6776f2cb8b08 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:29:41 +1100
Subject: [PATCH 19/48] Step 7.3: Add state dictionary to the body

---
 imports/ui/body.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index bac22c6..d429b10 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -1,10 +1,15 @@
 import { Template } from 'meteor/templating';
+import { ReactiveDict } from 'meteor/reactive-dict';
 
 import { Tasks } from '../api/tasks.js';
 
 import './task.js';
 import './body.html';
 
+Template.body.onCreated(function bodyOnCreated() {
+  this.state = new ReactiveDict();
+});
+
 Template.body.helpers({
   tasks() {
     // Show newest tasks at the top
-- 
2.11.0


From caa11a11d808123299380ee26229c9f358ba1775 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:30:11 +1100
Subject: [PATCH 20/48] Step 7.4: Add event handler for checkbox

---
 imports/ui/body.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index d429b10..856dad4 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -35,4 +35,7 @@ Template.body.events({
     // Clear form
     target.text.value = '';
   },
+  'change .hide-completed input'(event, instance) {
+    instance.state.set('hideCompleted', event.target.checked);
+  },
 });
-- 
2.11.0


From 10e30f2ff2b42a53bd675433f65d21ac2beb679e Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:31:16 +1100
Subject: [PATCH 21/48] Step 7.5: Add helpers to body template

---
 imports/ui/body.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index 856dad4..18422ae 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -12,7 +12,12 @@ Template.body.onCreated(function bodyOnCreated() {
 
 Template.body.helpers({
   tasks() {
-    // Show newest tasks at the top
+    const instance = Template.instance();
+    if (instance.state.get('hideCompleted')) {
+      // If hide completed is checked, filter tasks
+      return Tasks.find({ checked: { $ne: true } }, { sort: { createdAt: -1 } });
+    }
+    // Otherwise, return all of the tasks
     return Tasks.find({}, { sort: { createdAt: -1 } });
   },
 });
-- 
2.11.0


From 79b34c54716abd5aaa1a5d9f5068a8bd7c24e35b Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:26:17 -0700
Subject: [PATCH 22/48] Step 7.6: Add incompleteCount helper to body

---
 imports/ui/body.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index 18422ae..3ca9a47 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -20,6 +20,9 @@ Template.body.helpers({
     // Otherwise, return all of the tasks
     return Tasks.find({}, { sort: { createdAt: -1 } });
   },
+  incompleteCount() {
+    return Tasks.find({ checked: { $ne: true } }).count();
+  },
 });
 
 Template.body.events({
-- 
2.11.0


From b26b4d486c9136a3db7beb5d63759b7fa1cdf0b3 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:26:37 -0700
Subject: [PATCH 23/48] Step 7.7: Display incompleteCount

---
 imports/ui/body.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/body.html b/imports/ui/body.html
index b634377..6738d6c 100644
--- a/imports/ui/body.html
+++ b/imports/ui/body.html
@@ -1,7 +1,7 @@
 <body>
   <div class="container">
     <header>
-      <h1>Todo List</h1>
+      <h1>Todo List ({{incompleteCount}})</h1>
 
       <label class="hide-completed">
         <input type="checkbox" />
-- 
2.11.0


From eaa7cfb2bf6257ec2f64f9cfe454c688de9cc6c3 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:27:03 -0700
Subject: [PATCH 24/48] Step 8.1: Add accounts-ui and accounts-password

---
 .meteor/packages |  2 ++
 .meteor/versions | 14 ++++++++++++++
 2 files changed, 16 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a113025..5c68b39 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,5 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 reactive-dict
+accounts-ui
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index ccbd7bb..b739407 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,7 @@
+accounts-base@1.2.4-rc.2
+accounts-password@1.1.6-rc.2
+accounts-ui@1.1.7-rc.2
+accounts-ui-unstyled@1.1.10-rc.2
 allow-deny@1.0.2-rc.2
 autopublish@1.0.5-rc.2
 autoupdate@1.2.6-rc.2
@@ -16,12 +20,14 @@ check@1.1.2-rc.2
 ddp@1.2.3-rc.2
 ddp-client@1.2.3-rc.2
 ddp-common@1.2.3-rc.2
+ddp-rate-limiter@1.0.2-rc.2
 ddp-server@1.2.4-rc.2
 deps@1.0.10-rc.2
 diff-sequence@1.0.3-rc.2
 ecmascript@0.4.1-rc.2
 ecmascript-runtime@0.2.8-rc.2
 ejson@1.0.9-rc.2
+email@1.0.10-rc.2
 es5-shim@4.5.8-rc.2
 fastclick@1.0.9-rc.2
 geojson-utils@1.0.6-rc.2
@@ -33,7 +39,9 @@ id-map@1.0.5-rc.2
 insecure@1.0.5-rc.2
 jquery@1.11.6-rc.2
 launch-screen@1.0.7-rc.2
+less@2.5.5-rc.2
 livedata@1.0.16-rc.2
+localstorage@1.0.7-rc.2
 logging@1.0.10-rc.2
 meteor@1.1.12-rc.2
 meteor-base@1.0.2-rc.2
@@ -46,18 +54,24 @@ modules@0.5.1-rc.2
 modules-runtime@0.6.1-rc.2
 mongo@1.1.5-rc.2
 mongo-id@1.0.2-rc.2
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.41-rc.2
 observe-sequence@1.0.9-rc.2
 ordered-dict@1.0.5-rc.2
 promise@0.6.4-rc.2
 random@1.0.7-rc.2
+rate-limit@1.0.2-rc.2
 reactive-dict@1.1.5-rc.2
 reactive-var@1.0.7-rc.2
 reload@1.1.6-rc.2
 retry@1.0.5-rc.2
 routepolicy@1.0.8-rc.2
+service-configuration@1.0.7-rc.2
+session@1.1.3-rc.2
+sha@1.0.5-rc.2
 spacebars@1.0.9-rc.2
 spacebars-compiler@1.0.9-rc.2
+srp@1.0.6-rc.2
 standard-minifier-css@1.0.4-rc.2
 standard-minifier-js@1.0.4-rc.2
 templating@1.1.7-rc.2
-- 
2.11.0


From bc9fb936699c1ce8a0643e5c563043d560a04811 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:27:23 -0700
Subject: [PATCH 25/48] Step 8.2: Include loginButtons

---
 imports/ui/body.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/body.html b/imports/ui/body.html
index 6738d6c..6c60a17 100644
--- a/imports/ui/body.html
+++ b/imports/ui/body.html
@@ -8,6 +8,8 @@
         Hide Completed Tasks
       </label>
 
+      {{> loginButtons}}
+
       <form class="new-task">
         <input type="text" name="text" placeholder="Type to add new tasks" />
       </form>
-- 
2.11.0


From 7c48c9aa89e26eac39cc67046f85e54bab5889fe Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:36:02 +1100
Subject: [PATCH 26/48] Step 8.3: Configure accounts-ui

---
 imports/startup/accounts-config.js | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/startup/accounts-config.js

diff --git a/imports/startup/accounts-config.js b/imports/startup/accounts-config.js
new file mode 100644
index 0000000..7e4f7e5
--- /dev/null
+++ b/imports/startup/accounts-config.js
@@ -0,0 +1,5 @@
+import { Accounts } from 'meteor/accounts-base';
+
+Accounts.ui.config({
+  passwordSignupFields: 'USERNAME_ONLY',
+});
-- 
2.11.0


From 47fde1a42d5d6d1b765b2f16d0f0cc48e0567be1 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:36:36 +1100
Subject: [PATCH 27/48] Step 8.4: Import accounts configuration

---
 client/main.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/main.js b/client/main.js
index 4e7c1a4..739c50f 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1 +1,2 @@
+import '../imports/startup/accounts-config.js';
 import '../imports/ui/body.js';
-- 
2.11.0


From 2e4234a228346ca731731166ca12aa38c857d82d Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:28:24 -0700
Subject: [PATCH 28/48] Step 8.5: Update insert to include user data

---
 imports/ui/body.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index 3ca9a47..08fad55 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -1,3 +1,4 @@
+import { Meteor } from 'meteor/meteor';
 import { Template } from 'meteor/templating';
 import { ReactiveDict } from 'meteor/reactive-dict';
 
@@ -38,6 +39,8 @@ Template.body.events({
     Tasks.insert({
       text,
       createdAt: new Date(), // current time
+      owner: Meteor.userId(),
+      username: Meteor.user().username,
     });
 
     // Clear form
-- 
2.11.0


From 7083c5b56ba521ed7f34a7039bb3510e6f522534 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:28:47 -0700
Subject: [PATCH 29/48] Step 8.6: Only show add task form if logged in

---
 imports/ui/body.html | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/imports/ui/body.html b/imports/ui/body.html
index 6c60a17..6a9e4e1 100644
--- a/imports/ui/body.html
+++ b/imports/ui/body.html
@@ -10,9 +10,11 @@
 
       {{> loginButtons}}
 
-      <form class="new-task">
-        <input type="text" name="text" placeholder="Type to add new tasks" />
-      </form>
+      {{#if currentUser}}
+        <form class="new-task">
+          <input type="text" name="text" placeholder="Type to add new tasks" />
+        </form>
+      {{/if}}
     </header>
 
     <ul>
-- 
2.11.0


From da75b1705c5d5ae3470f47406c261d4303f95a87 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:29:11 -0700
Subject: [PATCH 30/48] Step 8.7: Display username next to task

---
 imports/ui/task.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/task.html b/imports/ui/task.html
index c4ab8e5..c42e8fc 100644
--- a/imports/ui/task.html
+++ b/imports/ui/task.html
@@ -4,6 +4,6 @@
 
     <input type="checkbox" checked="{{checked}}" class="toggle-checked" />
 
-    <span class="text">{{text}}</span>
+    <span class="text"><strong>{{username}}</strong> - {{text}}</span>
   </li>
 </template>
-- 
2.11.0


From fc20c31540886a1c6b63673217f63e485c076cec Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:29:52 -0700
Subject: [PATCH 31/48] Step 9.1: Remove insecure package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 5c68b39..d4578d9 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,7 +18,6 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 reactive-dict
 accounts-ui
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index b739407..3d9bd1e 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -36,7 +36,6 @@ html-tools@1.0.7-rc.2
 htmljs@1.0.7-rc.2
 http@1.1.3-rc.2
 id-map@1.0.5-rc.2
-insecure@1.0.5-rc.2
 jquery@1.11.6-rc.2
 launch-screen@1.0.7-rc.2
 less@2.5.5-rc.2
-- 
2.11.0


From aa0357a3c29f7fdedfbb7ff2b109e990831bb399 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:30:20 -0700
Subject: [PATCH 32/48] Step 9.2: Define some methods

---
 imports/api/tasks.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index 3bed819..0201eb4 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -1,3 +1,34 @@
+import { Meteor } from 'meteor/meteor';
 import { Mongo } from 'meteor/mongo';
+import { check } from 'meteor/check';
 
 export const Tasks = new Mongo.Collection('tasks');
+
+Meteor.methods({
+  'tasks.insert'(text) {
+    check(text, String);
+
+    // Make sure the user is logged in before inserting a task
+    if (! Meteor.userId()) {
+      throw new Meteor.Error('not-authorized');
+    }
+
+    Tasks.insert({
+      text,
+      createdAt: new Date(),
+      owner: Meteor.userId(),
+      username: Meteor.user().username,
+    });
+  },
+  'tasks.remove'(taskId) {
+    check(taskId, String);
+
+    Tasks.remove(taskId);
+  },
+  'tasks.setChecked'(taskId, setChecked) {
+    check(taskId, String);
+    check(setChecked, Boolean);
+
+    Tasks.update(taskId, { $set: { checked: setChecked } });
+  },
+});
-- 
2.11.0


From f6f479327894e4d8f1cd559cdb587c93a86acb33 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:31:24 -0700
Subject: [PATCH 33/48] Step 9.3: Replace insert with addTask method

---
 imports/ui/body.js | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index 08fad55..988f6a5 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -36,12 +36,7 @@ Template.body.events({
     const text = target.text.value;
 
     // Insert a task into the collection
-    Tasks.insert({
-      text,
-      createdAt: new Date(), // current time
-      owner: Meteor.userId(),
-      username: Meteor.user().username,
-    });
+    Meteor.call('tasks.insert', text);
 
     // Clear form
     target.text.value = '';
-- 
2.11.0


From 574d23454196ee22d0ea3bc6cd152b41e37e42cd Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:31:46 -0700
Subject: [PATCH 34/48] Step 9.4: Replace update and remove with methods

---
 imports/ui/task.js | 9 +++------
 1 file changed, 3 insertions(+), 6 deletions(-)

diff --git a/imports/ui/task.js b/imports/ui/task.js
index 782f932..3775ceb 100644
--- a/imports/ui/task.js
+++ b/imports/ui/task.js
@@ -1,17 +1,14 @@
+import { Meteor } from 'meteor/meteor';
 import { Template } from 'meteor/templating';
 
-import { Tasks } from '../api/tasks.js';
-
 import './task.html';
 
 Template.task.events({
   'click .toggle-checked'() {
     // Set the checked property to the opposite of its current value
-    Tasks.update(this._id, {
-      $set: { checked: ! this.checked },
-    });
+    Meteor.call('tasks.setChecked', this._id, !this.checked);
   },
   'click .delete'() {
-    Tasks.remove(this._id);
+    Meteor.call('tasks.remove', this._id);
   },
 });
-- 
2.11.0


From d96e7791d8be06e726b02b9a40abdc23630d99e6 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:32:19 -0700
Subject: [PATCH 35/48] Step 10.1: Remove autopublish

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index d4578d9..3ecf3a1 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,7 +17,6 @@ standard-minifier-js    # JS minifier run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
 
-autopublish             # Publish all data to the clients (for prototyping)
 reactive-dict
 accounts-ui
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 3d9bd1e..4f59e62 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -3,7 +3,6 @@ accounts-password@1.1.6-rc.2
 accounts-ui@1.1.7-rc.2
 accounts-ui-unstyled@1.1.10-rc.2
 allow-deny@1.0.2-rc.2
-autopublish@1.0.5-rc.2
 autoupdate@1.2.6-rc.2
 babel-compiler@6.5.1-rc.2
 babel-runtime@0.1.6-rc.2
-- 
2.11.0


From 09284b4286add29217f39a59c7b7c63b93d6a74f Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:45:32 +1100
Subject: [PATCH 36/48] Step 10.2: Add publication for tasks

---
 imports/api/tasks.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index 0201eb4..234a839 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -4,6 +4,13 @@ import { check } from 'meteor/check';
 
 export const Tasks = new Mongo.Collection('tasks');
 
+if (Meteor.isServer) {
+  // This code only runs on the server
+  Meteor.publish('tasks', function tasksPublication() {
+    return Tasks.find();
+  });
+}
+
 Meteor.methods({
   'tasks.insert'(text) {
     check(text, String);
-- 
2.11.0


From cf3557458e16d0477f61cd2cdc5d07adbe225de6 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:45:58 +1100
Subject: [PATCH 37/48] Step 10.3: Subscribe to tasks

---
 imports/ui/body.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/body.js b/imports/ui/body.js
index 988f6a5..8a4407f 100644
--- a/imports/ui/body.js
+++ b/imports/ui/body.js
@@ -9,6 +9,7 @@ import './body.html';
 
 Template.body.onCreated(function bodyOnCreated() {
   this.state = new ReactiveDict();
+  Meteor.subscribe('tasks');
 });
 
 Template.body.helpers({
-- 
2.11.0


From 559e0285e8d2ff713e00997b6f95463433fffa40 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:33:43 -0700
Subject: [PATCH 38/48] Step 10.4: Add private button

---
 imports/ui/task.html | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/imports/ui/task.html b/imports/ui/task.html
index c42e8fc..b9108ea 100644
--- a/imports/ui/task.html
+++ b/imports/ui/task.html
@@ -4,6 +4,16 @@
 
     <input type="checkbox" checked="{{checked}}" class="toggle-checked" />
 
+    {{#if isOwner}}
+      <button class="toggle-private">
+        {{#if private}}
+          Private
+        {{else}}
+          Public
+        {{/if}}
+      </button>
+    {{/if}}
+
     <span class="text"><strong>{{username}}</strong> - {{text}}</span>
   </li>
 </template>
-- 
2.11.0


From 0518f1f4682540652dfabb104fe9f8274ecab735 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:34:13 -0700
Subject: [PATCH 39/48] Step 10.5: Add private class to private tasks

---
 imports/ui/task.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/task.html b/imports/ui/task.html
index b9108ea..218789f 100644
--- a/imports/ui/task.html
+++ b/imports/ui/task.html
@@ -1,5 +1,5 @@
 <template name="task">
-  <li class="{{#if checked}}checked{{/if}}">
+  <li class="{{#if checked}}checked{{/if}} {{#if private}}private{{/if}}">
     <button class="delete">&times;</button>
 
     <input type="checkbox" checked="{{checked}}" class="toggle-checked" />
-- 
2.11.0


From 5f5dfb0eda840c8e796e07696e8412385453ead6 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:34:47 -0700
Subject: [PATCH 40/48] Step 10.6: Define helper to check ownership

---
 imports/ui/task.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/imports/ui/task.js b/imports/ui/task.js
index 3775ceb..af4bcf6 100644
--- a/imports/ui/task.js
+++ b/imports/ui/task.js
@@ -3,6 +3,12 @@ import { Template } from 'meteor/templating';
 
 import './task.html';
 
+Template.task.helpers({
+  isOwner() {
+    return this.owner === Meteor.userId();
+  },
+});
+
 Template.task.events({
   'click .toggle-checked'() {
     // Set the checked property to the opposite of its current value
-- 
2.11.0


From f3a0faebe7b53432e719148d109202a3179e207d Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:35:31 -0700
Subject: [PATCH 41/48] Step 10.7: Define method to set tasks to private

---
 imports/api/tasks.js | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index 234a839..f1d2c92 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -38,4 +38,17 @@ Meteor.methods({
 
     Tasks.update(taskId, { $set: { checked: setChecked } });
   },
+  'tasks.setPrivate'(taskId, setToPrivate) {
+    check(taskId, String);
+    check(setToPrivate, Boolean);
+
+    const task = Tasks.findOne(taskId);
+
+    // Make sure only the task owner can make a task private
+    if (task.owner !== Meteor.userId()) {
+      throw new Meteor.Error('not-authorized');
+    }
+
+    Tasks.update(taskId, { $set: { private: setToPrivate } });
+  },
 });
-- 
2.11.0


From e666e1411463ac2e076bd6b966c6ec9c85b504bd Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:35:55 -0700
Subject: [PATCH 42/48] Step 10.8: Add event handler to call the setPrivate
 method

---
 imports/ui/task.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/task.js b/imports/ui/task.js
index af4bcf6..6b51496 100644
--- a/imports/ui/task.js
+++ b/imports/ui/task.js
@@ -17,4 +17,7 @@ Template.task.events({
   'click .delete'() {
     Meteor.call('tasks.remove', this._id);
   },
+  'click .toggle-private'() {
+    Meteor.call('tasks.setPrivate', this._id, !this.private);
+  },
 });
-- 
2.11.0


From 1501ba07e7032887345eddef0fe542bfc8a21283 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:36:38 -0700
Subject: [PATCH 43/48] Step 10.9: Only publish tasks the user is allowed to
 see

---
 imports/api/tasks.js | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index f1d2c92..441feee 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -6,8 +6,14 @@ export const Tasks = new Mongo.Collection('tasks');
 
 if (Meteor.isServer) {
   // This code only runs on the server
+  // Only publish tasks that are public or belong to the current user
   Meteor.publish('tasks', function tasksPublication() {
-    return Tasks.find();
+    return Tasks.find({
+      $or: [
+        { private: { $ne: true } },
+        { owner: this.userId },
+      ],
+    });
   });
 }
 
-- 
2.11.0


From b47254b75a77b7e17374a0cfefaa2b491db047bf Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Tue, 14 Jul 2015 19:37:36 -0700
Subject: [PATCH 44/48] Step 10.10: Add some extra security to methods

---
 imports/api/tasks.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index 441feee..9d5b56a 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -36,12 +36,24 @@ Meteor.methods({
   'tasks.remove'(taskId) {
     check(taskId, String);
 
+    const task = Tasks.findOne(taskId);
+    if (task.private && task.owner !== Meteor.userId()) {
+      // If the task is private, make sure only the owner can delete it
+      throw new Meteor.Error('not-authorized');
+    }
+
     Tasks.remove(taskId);
   },
   'tasks.setChecked'(taskId, setChecked) {
     check(taskId, String);
     check(setChecked, Boolean);
 
+    const task = Tasks.findOne(taskId);
+    if (task.private && task.owner !== Meteor.userId()) {
+      // If the task is private, make sure only the owner can check it off
+      throw new Meteor.Error('not-authorized');
+    }
+
     Tasks.update(taskId, { $set: { checked: setChecked } });
   },
   'tasks.setPrivate'(taskId, setToPrivate) {
-- 
2.11.0


From c9b1dd8bbc52eeebc6ea8d8c80147d11fc3a582d Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Thu, 17 Mar 2016 12:51:38 +1100
Subject: [PATCH 45/48] Step 11.1: Added practicalmeteor:mocha package

---
 .meteor/packages | 1 +
 .meteor/versions | 7 +++++++
 2 files changed, 8 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 3ecf3a1..6e6d2d4 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 reactive-dict
 accounts-ui
 accounts-password
+practicalmeteor:mocha@2.1.1-rc.1
diff --git a/.meteor/versions b/.meteor/versions
index 4f59e62..a03c196 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -16,6 +16,7 @@ caching-compiler@1.0.2-rc.2
 caching-html-compiler@1.0.4-rc.2
 callback-hook@1.0.6-rc.2
 check@1.1.2-rc.2
+coffeescript@1.0.15-rc.2
 ddp@1.2.3-rc.2
 ddp-client@1.2.3-rc.2
 ddp-common@1.2.3-rc.2
@@ -56,6 +57,11 @@ npm-bcrypt@0.7.8_2
 npm-mongo@1.4.41-rc.2
 observe-sequence@1.0.9-rc.2
 ordered-dict@1.0.5-rc.2
+practicalmeteor:chai@2.1.0_1
+practicalmeteor:loglevel@1.2.0_2
+practicalmeteor:mocha@2.1.1-rc.1
+practicalmeteor:mocha-core@0.1.4
+practicalmeteor:sinon@1.14.1_2
 promise@0.6.4-rc.2
 random@1.0.7-rc.2
 rate-limit@1.0.2-rc.2
@@ -74,6 +80,7 @@ standard-minifier-css@1.0.4-rc.2
 standard-minifier-js@1.0.4-rc.2
 templating@1.1.7-rc.2
 templating-tools@1.0.2-rc.2
+tmeasday:test-reporter-helpers@0.2.1
 tracker@1.0.11-rc.2
 ui@1.0.9-rc.2
 underscore@1.0.6-rc.2
-- 
2.11.0


From 92f2ca1d2865a5fd196879bb0185fd2edf3c619c Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 12:36:41 +1100
Subject: [PATCH 46/48] Step 11.2: Add a scaffold for a method test

---
 imports/api/tasks.tests.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 imports/api/tasks.tests.js

diff --git a/imports/api/tasks.tests.js b/imports/api/tasks.tests.js
new file mode 100644
index 0000000..05287ba
--- /dev/null
+++ b/imports/api/tasks.tests.js
@@ -0,0 +1,12 @@
+/* eslint-env mocha */
+
+import { Meteor } from 'meteor/meteor';
+
+if (Meteor.isServer) {
+  describe('Tasks', () => {
+    describe('methods', () => {
+      it('can delete owned task', () => {
+      });
+    });
+  });
+}
-- 
2.11.0


From cd403a50cacba784de11a7a94e6d55bc884b33fb Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 12:37:45 +1100
Subject: [PATCH 47/48] Step 11.3: Prepare the database for each test

---
 imports/api/tasks.tests.js | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/imports/api/tasks.tests.js b/imports/api/tasks.tests.js
index 05287ba..1359e85 100644
--- a/imports/api/tasks.tests.js
+++ b/imports/api/tasks.tests.js
@@ -1,10 +1,26 @@
 /* eslint-env mocha */
 
 import { Meteor } from 'meteor/meteor';
+import { Random } from 'meteor/random';
+
+import { Tasks } from './tasks.js';
 
 if (Meteor.isServer) {
   describe('Tasks', () => {
     describe('methods', () => {
+      const userId = Random.id();
+      let taskId;
+
+      beforeEach(() => {
+        Tasks.remove({});
+        taskId = Tasks.insert({
+          text: 'test task',
+          createdAt: new Date(),
+          owner: userId,
+          username: 'tmeasday',
+        });
+      });
+
       it('can delete owned task', () => {
       });
     });
-- 
2.11.0


From 9a08b96bae018a4ecb3d23dada624accdb817cb0 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 12:39:33 +1100
Subject: [PATCH 48/48] Step 11.4: Added test to check delete method

---
 imports/api/tasks.tests.js | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/imports/api/tasks.tests.js b/imports/api/tasks.tests.js
index 1359e85..9b61c5a 100644
--- a/imports/api/tasks.tests.js
+++ b/imports/api/tasks.tests.js
@@ -2,6 +2,7 @@
 
 import { Meteor } from 'meteor/meteor';
 import { Random } from 'meteor/random';
+import { assert } from 'meteor/practicalmeteor:chai';
 
 import { Tasks } from './tasks.js';
 
@@ -22,6 +23,18 @@ if (Meteor.isServer) {
       });
 
       it('can delete owned task', () => {
+        // Find the internal implementation of the task method so we can
+        // test it in isolation
+        const deleteTask = Meteor.server.method_handlers['tasks.remove'];
+
+        // Set up a fake method invocation that looks like what the method expects
+        const invocation = { userId };
+
+        // Run the method with `this` set to the fake invocation
+        deleteTask.apply(invocation, [taskId]);
+
+        // Verify that the method does what we expected
+        assert.equal(Tasks.find().count(), 0);
       });
     });
   });
-- 
2.11.0

